#!/bin/bash

RUID=ajhajj@redhat.com

podman login -u ${RUID} https://registry.redhat.io

while IFS="" read -r IMAGE || [ -n "${IMAGE}" ]
do
    NAME=$(echo ${IMAGE} | sed -e 's/:.*$//' -e 's@.*/@@')
    echo "Exporting filesystem for ${IMAGE} to ${NAME}.tar"
    podman pull ${IMAGE} > /dev/null 2>&1
    CID=$(podman create ${IMAGE})
    podman export ${CID} > ${NAME}.tar
    podman rm ${CID} > /dev/null 2>&1 
done < containers.txt
