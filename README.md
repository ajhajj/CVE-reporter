# CVE-reporter
Script(s) to exercise Red Hat's Security Data API.

## Script: csvEnricher.sh

### Description:
This script will ingest a CSV formatted spreadsheet report (typically from a vendor like Twistlock).   The script will read CVE IDs from the column that you specify.  Then for each CVE ID in that column it will query Red Hat's Security Data API to retreive available data as JSON documents.  The tool will then parse those documents for specific data fields which will be added as columns to the output CSV document using headings as shown below. 

| RH_CSSV_SCORE |RH_CSSV_VECTOR |RH_CSSV_STATUS|RH_STATEMENT  | RH_CVE_DB_LINK |
| :-----------: |:-------------:| :-----------:|:-----------: |:-----------: |
| cvss_base_score | cvss_scoring_vector | cvss status | statement | https://.../security/cve... |

### Configuration:
At the beginning of the script we have variable definitions.  The following variables values should be changed for your environment:
* `INPUT_FILE=twistlock.csv` - The input CSV formatted spreadsheet filename
* `OUTPUT_FILE=output.csv`- The output CSV formatted spreadsheet filename
* `CVE_ID="CVE ID"` - The name of the column containing CVE IDs
### Dependencies:
The script depends on several commandline tools.  This script was developed on Fedora 31 with the following versions of these tools.  Other versions may work but have not been tested by me.
| Tool | Version |
| :-----------: |:-------------:|
| awk |GNU Awk 5.0.1, API: 3.0 (GNU MPFR 3.1.6-p2, GNU MP 6.1.2) |
| tr | tr (GNU coreutils) 8.31 |
| sort | sort (GNU coreutils) 8.31 |
| wget | GNU Wget 1.20.3 built on linux-gnu |
| sed | sed (GNU sed) 4.5 |
| jq | jq-1.6 |
| cat | cat (GNU coreutils) 8.31 |
